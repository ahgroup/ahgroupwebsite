<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Types of Uncertainty in Modeling</title>
    <meta charset="utf-8" />
    <meta name="author" content="Andreas Handel" />
    <meta name="date" content="2019-07-04" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="media\handelslides.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, title-slide, title-slide

# Types of Uncertainty in Modeling
### Andreas Handel
### University of Georgia
### 2019-07-04

---



# Uncertainty
* Model results have different sources of uncertainty attached to them.
* Not all types of uncertainty are always explicitly acknowledged. 
* That's true not only for mathematical/computer models.

---
class: center, middle

# Structural Uncertainty

---
# Structural Uncertainty
* Models are simplifications and abstractions of the real world.
* Specific assumptions lead to different models.
* Every model is 'wrong' in some sense, but some might be useful.

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./media/mapfigure.png" alt="Which one is the right model of Georgia?" width="100%" /&gt;
&lt;p class="caption"&gt;Which one is the right model of Georgia?&lt;/p&gt;
&lt;/div&gt;



---
# Structural Uncertainty
* We need to decide which variables and processes to include and which to exclude.
  * Include age or not?
  * Allow for co-infection or not?
  * Include treatment or not?
* Once we have decided on that, we need to decide how to model each process.
  * What type of model? (ODE, IBM, etc.)
  * How to implement each process?


---
# Example variants of specific processes

.pull-left[
Interaction: Mass-action or saturating?

$$
`\begin{aligned}
\dot S &amp; = -bSI \\
\dot I &amp;  = bSI - g I \\
\dot R &amp;  = g I \\
\\
\dot S &amp; =  - \frac{bSI}{S+I+k} \\
\dot I &amp;  = \frac{bSI}{S+I+k} - gI \\
\dot R &amp;  = gI \\
\end{aligned}`
$$

]
.pull-right[
Growth: Exponential or Linear or Saturating?

$$
`\begin{aligned}
\dot{B} &amp; = g B(1-\frac{B}{B_{max}}) - d_B B - kBI\\
\dot{I} &amp; = r BI - d_I I \\
\\
\dot{B} &amp; = g - d_B B - kBI\\
\dot{I} &amp; = r BI - d_I I \\
\end{aligned}`
$$



]



---
# Structural Uncertainty - Example
* Multi-group effort to use computer models to predict how different interventions affect TB incidence and prevalence in 2025.

&lt;img src="./media/TBMAClogos.png" width="100%" style="display: block; margin: auto;" /&gt;

* More details:
  * Houben et al _"Feasibility of achieving the 2025 WHO global tuberculosis targets in South Africa, China, and India: a combined analysis of 11 mathematical models."_ Lancet Global Health, 2016.
  * Menzies et al _"Cost-effectiveness and resource implications of aggressive action on tuberculosis in China, India, and South Africa: a combined analysis of nine models."_ Lancet Global Health, 2016.

---
# Structural Uncertainty - Example
&lt;img src="./media/tbmaccalibration.jpg" width="80%" style="display: block; margin: auto;" /&gt;

---
# Structural Uncertainty - Example
&lt;img src="./media/tbmacprediction.jpg" width="70%" style="display: block; margin: auto;" /&gt;



---
class: center, middle

# Parameter Uncertainty


---
# Exploring the impact of model parameters 
* Often, we do not know the values for the model parameters very well.
* Sometimes we can obtain estimates for parameter values from fitting to data, but the right data is often not available.
* Instead of running our model for just one set of parameter values, we could run it using different values that are within reasonable ranges.
* If we have a small model, we could systematically explore model behavior for each parameter.

&lt;img src="./media/modelexploration.png" width="55%" style="display: block; margin: auto;" /&gt;


---
# Exploring the impact of model parameters 
* Once models get big, it would take too long to thoroughly scan over all parameters.
* Often we can get reasonable ranges from the literature, but not exact values.
* Sometimes, we might be _mainly_ interested in how results change as we vary one parameter, but we also want to know how uncertainty in other parameters affect our outcome.
* Other times, we might want to use our model to make predictions. We need to figure out how uncertainty in parameters affects our predictions. 

---
# Uncertainty &amp; Sensitivity Analysis
Varying multiple inputs/parameters over a usually broad range is called a (global) uncertainty &amp; sensitivity analysis.

* __Uncertainty Analysis:__ Given uncertainty in the inputs (parameters), how much uncertainty is there in the outputs/results?
* __Sensitivity Analysis:__ How much do individual inputs contribute to the uncertainty in outputs/results? 

---
# Doing Uncertainty &amp; Sensitivity Analysis
* Determine ranges of uncertainty for each input (parameter and initial conditions). 
* Repeatedly draw samples of parameter values from the specified distributions.
* Run model for each parameter sample, record outcomes.

---
# Parameter ranges
For each parameter, specify its distribution:

* Single value if we are very certain.
* Uniform distribution between some min and max values if we know very little.
* A 'peaked' distribution (e.g. gamma, log-normal) if we are fairly certain about some parameters.

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./media/paramdistribution.jpg" alt="Hoare et al 2008 TBMM" width="50%" /&gt;
&lt;p class="caption"&gt;Hoare et al 2008 TBMM&lt;/p&gt;
&lt;/div&gt;

---
# Parameter sampling
* Exhaustively trying all parameter value combinations takes too long.
* Randomly sampling is not efficient, it might leave areas of parameter space unexplored.
* A method called Latin Hypercube Sampling creates samples that efficiently span the parameter space.

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./media/lhsfigure.jpg" alt="Hoare et al 2008 TBMM" width="100%" /&gt;
&lt;p class="caption"&gt;Hoare et al 2008 TBMM&lt;/p&gt;
&lt;/div&gt;

---
# Uncertainty Analysis - Example
* Question: What is the impact of different antiviral and antibacterial treatment strategies on deaths and cases during an influenza pandemic in the presence of bacterial co-infection?
* ODE equation model with 13 variables/equations and 47 parameters.
* Investigated the impact of 5 different treatment strategies on 4 outcomes: reduction in total cases, bacteria cases, peak cases and deaths.
* More details: Handel et al (2009) Epidemics _"Intervention strategies for an influenza pandemic taking into account secondary bacterial infections"_.


---
# Uncertainty Analysis - Example
* For each parameter sample, we run the simulation and record the result.
* We can then see how uncertainty in inputs affects the results.
* A convenient way to represent the results is by using boxplots.

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./media/pandemicusanalysis1.jpg" alt="Handel et al (2009), Epidemics" width="50%" /&gt;
&lt;p class="caption"&gt;Handel et al (2009), Epidemics&lt;/p&gt;
&lt;/div&gt;

---
# Sensitivity Analysis
* Uncertainty analyis tells us how uncertainty in inputs affects uncertainty in outputs.
* If we want to know in more detail how a specific input affects a specific output, we can move on to sensitivity analysis.
* Using the same simulation results, we now plot scatterplots for income/outcome pairs of interest instead of boxplots.

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./media/pandemicusanalysis2.jpg" alt="Handel et al (2009), Epidemics" width="40%" /&gt;
&lt;p class="caption"&gt;Handel et al (2009), Epidemics&lt;/p&gt;
&lt;/div&gt;

---
# Sensitivity Analysis
* If the scatterplot shows a monotone relation, we can summarize it with a single number, a correlation coefficient
* Correlation Coefficients (CC) indicate how correlated a given output is with a given input.
* CC are between -1 and 1. Large CC means strong (negative) correlation, CC â‰ˆ 0 means no correlation.
* Input-output relations are often nonlinear, therefore computing the linear correlation is often not the best measure.
* Using a Rank CC is usually more suitable.
* Partial Rank Correlation Coefficients (PRCC) are even better if multiple inputs/parameters are changed at the same time.

---
# U/S Analysis - Summary
* Uncertainty in parameters can be fairly easily quantified.
* By sampling over parameters, one can obtain confidence intervals or similar measures of uncertainty.
* __This does not account for structural or inherent uncertainty!__




---
class: center, middle

# Inherent/Stochastic Uncertainty



---
# Introduction 
* Deterministic models (both continuous and discrete-time) give you the same result for a set of parameters and starting conditions no matter how often you run them.
* Real systems are stochastic/random, which means they home some inherent variability.
* The words Stochasticity, Randomness, Noise, Variability are often used interchangably.

---
# Sources of Stochasticity
* Random (external) noise (e.g. measurement error)
* Fluctuations in parameters (e.g. temperature)
* Unpredictability of event occurence (e.g. births, deaths)

---
# When is stochasticity important
* For small numbers
* When we want to answer questions such as 'what is the probability that X will happen'?

---
# Stochastic compartmental models
We can fairly easily formulate any compartmental model (e.g. and ODE model) as a stochastic model.

* All variables take on discrete values (0,1,2,...).
* Increases or decreases are dicated by inflows and outflows.
* At each time step, one of the possible inflows/outflows occurs, with probability based on the size of the term.


---
# Some terminology
* The events that happen are often called reactions or transitions.
* The inflow and outflow terms are called propensities, multiplied by the time step they are probabilities.


---
# Example 1

$$
`\begin{aligned}
\dot S &amp; = m - bSI - nS \\
\dot I &amp; = bSI - gI - nI \\
\dot R &amp; = gI - nR \\
\end{aligned}`
$$

Event type              |  Transitions        |   Propensity      |
----------              |  -----------        |   ----------      |
Infection               |  S =&gt; S-1, I =&gt; I+1 |   bSI   |
Recovery                |  I =&gt; I-1, R =&gt; R+1 |   gI           |
Births                  |  S =&gt; S+1           |   m          |
Death of susceptible    |  S =&gt; S-1           |   nS          | 
Death of infected       |  I =&gt; I-1           |   nI          |
Death of recovered      |  R =&gt; R-1           |   nR          |




---
# Example 2

$$
`\begin{aligned}
\textrm{Uninfected Cells} \qquad \dot{U} &amp; = n -d_U U - bUV \\
\textrm{Infected Cells} \qquad \dot{I} &amp; =  bUV - d_I I \\     
\textrm{Virus} \qquad  \dot{V} &amp; =  pI - d_V V -  b UV 
\end{aligned}`
$$

Event type              |  Transitions                  |   Propensity      |
----------              |  -----------                  |   ----------      |
Production of U         |  U =&gt; U+1                     |   n            |
death/removal of U      |  U =&gt; U-1                     |   `\(d_U\)`U           |
infection               |  U =&gt; U-1, V =&gt; V-1, I =&gt; I+1 |   bUV           |
death if I              |  I =&gt; I-1                     |   `\(d_I\)`I          |
production of V         |  V =&gt; V+1                     |   pI          |
removal of V            |  V =&gt; V-1                     |   `\(d_V\)`V          | 


---
# Comments
* Stochastic models are not much harder to implement, but they require more computational time since we need to run ensembles.
* One can fit stochastic models to data, but that's tricky and takes a long time.
* The `adaptivetau` package in R makes implementing stochastic models easy.
* The `pomp` package in R is a good tool for fitting stochastic models.

---
# Summary
* Uncertainty in modeling results can come from different sources.
* Structural uncertainty is arguably the most important but rarely explored. (Similar problems exist outside of modeling, e.g. how good a model are mice or elite undergrad students for the general population?)
* Parameter uncertainty is increasingly included in modeling projects and should be explored if a model is used for prediction.
* Stochastic models are also becoming more common but are still somewhat harder to work with.


---
# Learn more

DSAIDE:
* _Uncertainty and sensitivity_ app.
* The apps in the _Stochastic models_ section.

DSAIRM:
* _Model variant exploration_ app.
* _Uncertainty and sensitivity analysis_ app.
* The _Stochastic Model_ and _Influenza antivirals and resistance_ apps illustrate stochastic models.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
